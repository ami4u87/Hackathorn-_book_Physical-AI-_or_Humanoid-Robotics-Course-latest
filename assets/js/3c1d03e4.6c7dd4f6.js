"use strict";(globalThis.webpackChunkphysical_ai_humanoid_robotics=globalThis.webpackChunkphysical_ai_humanoid_robotics||[]).push([[838],{3146:(e,a,r)=>{r.r(a),r.d(a,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>o,toc:()=>m});var n=r(4848),t=r(8453);const s={},i="Parameters",o={id:"module-1-ros2/parameters",title:"Parameters",description:"Parameters in ROS 2 provide a way to configure nodes dynamically at runtime. They allow you to modify node behavior without recompiling code, making your robotic systems more flexible and easier to tune. Parameters can be set at launch time, changed during runtime, and even declared with specific types and constraints.",source:"@site/docs/module-1-ros2/5-parameters.md",sourceDirName:"module-1-ros2",slug:"/module-1-ros2/parameters",permalink:"/Hackathorn-_book_Physical-AI-_or_Humanoid-Robotics-Course-latest/docs/module-1-ros2/parameters",draft:!1,unlisted:!1,editUrl:"https://github.com/ami4u87/Hackathorn-_book_Physical-AI-_or_Humanoid-Robotics-Course-latest/tree/master/docs/module-1-ros2/5-parameters.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{},sidebar:"docsSidebar",previous:{title:"Actions",permalink:"/Hackathorn-_book_Physical-AI-_or_Humanoid-Robotics-Course-latest/docs/module-1-ros2/actions"},next:{title:"Launch Files",permalink:"/Hackathorn-_book_Physical-AI-_or_Humanoid-Robotics-Course-latest/docs/module-1-ros2/launch"}},l={},m=[{value:"Understanding Parameters",id:"understanding-parameters",level:2},{value:"Declaring and Using Parameters",id:"declaring-and-using-parameters",level:2},{value:"Python Parameter Example",id:"python-parameter-example",level:3},{value:"Setting Parameters at Launch Time",id:"setting-parameters-at-launch-time",level:2},{value:"Setting Parameters from Command Line",id:"setting-parameters-from-command-line",level:2},{value:"Parameter Files",id:"parameter-files",level:2},{value:"Advanced Parameter Concepts",id:"advanced-parameter-concepts",level:2},{value:"Parameter Descriptors",id:"parameter-descriptors",level:3},{value:"Parameter Callbacks with Validation",id:"parameter-callbacks-with-validation",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Command Line Tools",id:"command-line-tools",level:2},{value:"Summary",id:"summary",level:2}];function c(e){const a={code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.h1,{id:"parameters",children:"Parameters"}),"\n",(0,n.jsx)(a.p,{children:"Parameters in ROS 2 provide a way to configure nodes dynamically at runtime. They allow you to modify node behavior without recompiling code, making your robotic systems more flexible and easier to tune. Parameters can be set at launch time, changed during runtime, and even declared with specific types and constraints."}),"\n",(0,n.jsx)(a.h2,{id:"understanding-parameters",children:"Understanding Parameters"}),"\n",(0,n.jsx)(a.p,{children:"Parameters are key-value pairs that can be associated with a node. They provide a way to:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsx)(a.li,{children:"Configure node behavior without recompilation"}),"\n",(0,n.jsx)(a.li,{children:"Tune algorithm parameters during operation"}),"\n",(0,n.jsx)(a.li,{children:"Set initial conditions or configuration values"}),"\n",(0,n.jsx)(a.li,{children:"Adapt to different environments or hardware"}),"\n"]}),"\n",(0,n.jsx)(a.p,{children:"Parameters can be of various types:"}),"\n",(0,n.jsxs)(a.ul,{children:["\n",(0,n.jsxs)(a.li,{children:["Integer (",(0,n.jsx)(a.code,{children:"int"}),")"]}),"\n",(0,n.jsxs)(a.li,{children:["Double (",(0,n.jsx)(a.code,{children:"float"}),")"]}),"\n",(0,n.jsxs)(a.li,{children:["String (",(0,n.jsx)(a.code,{children:"str"}),")"]}),"\n",(0,n.jsxs)(a.li,{children:["Boolean (",(0,n.jsx)(a.code,{children:"bool"}),")"]}),"\n",(0,n.jsx)(a.li,{children:"Lists of the above types"}),"\n"]}),"\n",(0,n.jsx)(a.h2,{id:"declaring-and-using-parameters",children:"Declaring and Using Parameters"}),"\n",(0,n.jsx)(a.h3,{id:"python-parameter-example",children:"Python Parameter Example"}),"\n",(0,n.jsx)(a.p,{children:"Let's create a node that uses parameters. First, create a new package:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"cd ~/ros2_ws/src\nros2 pkg create --build-type ament_python py_parameters\n"})}),"\n",(0,n.jsxs)(a.p,{children:["Create a parameter node at ",(0,n.jsx)(a.code,{children:"src/py_parameters/py_parameters/parameter_node.py"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\n\n\nclass ParameterNode(Node):\n\n    def __init__(self):\n        super().__init__('parameter_node')\n\n        # Declare parameters with default values and descriptions\n        self.declare_parameter('robot_name', 'turtlebot4')\n        self.declare_parameter('max_velocity', 0.5)\n        self.declare_parameter('use_sim_time', False)\n        self.declare_parameter('sensors', ['imu', 'lidar', 'camera'])\n\n        # Get parameter values\n        self.robot_name = self.get_parameter('robot_name').value\n        self.max_velocity = self.get_parameter('max_velocity').value\n        self.use_sim_time = self.get_parameter('use_sim_time').value\n        self.sensors = self.get_parameter('sensors').value\n\n        self.get_logger().info(f'Robot name: {self.robot_name}')\n        self.get_logger().info(f'Max velocity: {self.max_velocity}')\n        self.get_logger().info(f'Use sim time: {self.use_sim_time}')\n        self.get_logger().info(f'Sensors: {self.sensors}')\n\n        # Set up a parameter callback to handle dynamic reconfiguration\n        self.add_on_set_parameters_callback(self.parameter_callback)\n\n    def parameter_callback(self, params):\n        for param in params:\n            if param.name == 'max_velocity' and param.type_ == Parameter.Type.DOUBLE:\n                if param.value > 2.0:\n                    self.get_logger().warn('Max velocity is set too high!')\n                    return SetParametersResult(successful=False, reason='Velocity too high')\n\n        return SetParametersResult(successful=True)\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    parameter_node = ParameterNode()\n\n    # Example of setting a parameter from within the node\n    parameter_node.set_parameters([Parameter('max_velocity', Parameter.Type.DOUBLE, 1.0)])\n\n    rclpy.spin(parameter_node)\n\n    parameter_node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,n.jsx)(a.p,{children:"Note: We need to import the Parameter class and SetParametersResult:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-python",children:"import rclpy\nfrom rclpy.node import Node\nfrom rclpy.parameter import Parameter\nfrom rcl_interfaces.msg import ParameterDescriptor\nfrom rcl_interfaces.msg import SetParametersResult\n\n\nclass ParameterNode(Node):\n\n    def __init__(self):\n        super().__init__('parameter_node')\n\n        # Declare parameters with default values and descriptions\n        self.declare_parameter('robot_name', 'turtlebot4',\n                              ParameterDescriptor(description='Name of the robot'))\n        self.declare_parameter('max_velocity', 0.5,\n                              ParameterDescriptor(description='Maximum linear velocity (m/s)'))\n        self.declare_parameter('use_sim_time', False,\n                              ParameterDescriptor(description='Use simulation time'))\n        self.declare_parameter('sensors', ['imu', 'lidar', 'camera'],\n                              ParameterDescriptor(description='List of sensor types'))\n\n        # Get parameter values\n        self.robot_name = self.get_parameter('robot_name').value\n        self.max_velocity = self.get_parameter('max_velocity').value\n        self.use_sim_time = self.get_parameter('use_sim_time').value\n        self.sensors = self.get_parameter('sensors').value\n\n        self.get_logger().info(f'Robot name: {self.robot_name}')\n        self.get_logger().info(f'Max velocity: {self.max_velocity}')\n        self.get_logger().info(f'Use sim time: {self.use_sim_time}')\n        self.get_logger().info(f'Sensors: {self.sensors}')\n\n        # Set up a parameter callback to handle dynamic reconfiguration\n        self.add_on_set_parameters_callback(self.parameter_callback)\n\n    def parameter_callback(self, params):\n        for param in params:\n            if param.name == 'max_velocity' and param.type_ == Parameter.Type.DOUBLE:\n                if param.value > 2.0:\n                    self.get_logger().warn('Max velocity is set too high!')\n                    result = SetParametersResult()\n                    result.successful = False\n                    result.reason = 'Velocity too high'\n                    return result\n\n        result = SetParametersResult()\n        result.successful = True\n        return result\n\n\ndef main(args=None):\n    rclpy.init(args=args)\n\n    parameter_node = ParameterNode()\n\n    rclpy.spin(parameter_node)\n\n    parameter_node.destroy_node()\n    rclpy.shutdown()\n\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,n.jsx)(a.h2,{id:"setting-parameters-at-launch-time",children:"Setting Parameters at Launch Time"}),"\n",(0,n.jsxs)(a.p,{children:["You can set parameters when launching a node using launch files. Create a launch file at ",(0,n.jsx)(a.code,{children:"src/py_parameters/launch/parameter_launch.py"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\n\n\ndef generate_launch_description():\n    return LaunchDescription([\n        Node(\n            package='py_parameters',\n            executable='parameter_node',\n            name='parameter_node',\n            parameters=[\n                {'robot_name': 'husky'},\n                {'max_velocity': 1.0},\n                {'use_sim_time': True},\n                {'sensors': ['lidar', 'camera', 'gps']}\n            ]\n        )\n    ])\n"})}),"\n",(0,n.jsx)(a.h2,{id:"setting-parameters-from-command-line",children:"Setting Parameters from Command Line"}),"\n",(0,n.jsx)(a.p,{children:"You can also set parameters directly from the command line:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"# Run the node with specific parameters\nros2 run py_parameters parameter_node --ros-args -p robot_name:=jackal -p max_velocity:=2.0\n\n# Or use the parameter server\nros2 param set /parameter_node max_velocity 1.5\n\n# Get parameter value\nros2 param get /parameter_node robot_name\n\n# List all parameters for a node\nros2 param list /parameter_node\n"})}),"\n",(0,n.jsx)(a.h2,{id:"parameter-files",children:"Parameter Files"}),"\n",(0,n.jsxs)(a.p,{children:["You can also define parameters in YAML files and load them at launch. Create a parameter file at ",(0,n.jsx)(a.code,{children:"src/py_parameters/config/params.yaml"}),":"]}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-yaml",children:"parameter_node:\n  ros__parameters:\n    robot_name: 'turtlebot4'\n    max_velocity: 0.5\n    use_sim_time: false\n    sensors: ['imu', 'lidar', 'camera']\n    wheel_diameter: 0.1\n    max_acceleration: 1.0\n"})}),"\n",(0,n.jsx)(a.p,{children:"Then load it in your launch file:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-python",children:"from launch import LaunchDescription\nfrom launch_ros.actions import Node\nfrom ament_index_python.packages import get_package_share_directory\nimport os\n\n\ndef generate_launch_description():\n    config = os.path.join(\n        get_package_share_directory('py_parameters'),\n        'config',\n        'params.yaml'\n    )\n\n    return LaunchDescription([\n        Node(\n            package='py_parameters',\n            executable='parameter_node',\n            name='parameter_node',\n            parameters=[config]\n        )\n    ])\n"})}),"\n",(0,n.jsx)(a.h2,{id:"advanced-parameter-concepts",children:"Advanced Parameter Concepts"}),"\n",(0,n.jsx)(a.h3,{id:"parameter-descriptors",children:"Parameter Descriptors"}),"\n",(0,n.jsx)(a.p,{children:"You can add metadata to parameters using descriptors:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-python",children:"from rcl_interfaces.msg import ParameterDescriptor\nfrom rcl_interfaces.msg import IntegerRange, FloatingPointRange\n\n# For integer parameters with range\nself.declare_parameter(\n    'wheel_count',\n    4,\n    ParameterDescriptor(\n        description='Number of wheels on the robot',\n        integer_range=[IntegerRange(from_value=2, to_value=8, step=2)]\n    )\n)\n\n# For floating point parameters with range\nself.declare_parameter(\n    'max_velocity',\n    0.5,\n    ParameterDescriptor(\n        description='Maximum linear velocity in m/s',\n        floating_point_range=[FloatingPointRange(from_value=0.0, to_value=5.0, step=0.1)]\n    )\n)\n"})}),"\n",(0,n.jsx)(a.h3,{id:"parameter-callbacks-with-validation",children:"Parameter Callbacks with Validation"}),"\n",(0,n.jsx)(a.p,{children:"You can implement complex validation logic in parameter callbacks:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-python",children:"def parameter_callback(self, params):\n    successful = True\n    reason = ''\n\n    for param in params:\n        if param.name == 'max_velocity':\n            if param.value <= 0:\n                successful = False\n                reason = 'Max velocity must be positive'\n                break\n            elif param.value > 5.0:\n                successful = False\n                reason = 'Max velocity must be <= 5.0 m/s'\n                break\n        elif param.name == 'robot_name':\n            if not isinstance(param.value, str) or len(param.value) == 0:\n                successful = False\n                reason = 'Robot name must be a non-empty string'\n                break\n\n    return SetParametersResult(successful=successful, reason=reason)\n"})}),"\n",(0,n.jsx)(a.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,n.jsxs)(a.ol,{children:["\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Use descriptive parameter names"}),": Choose clear, consistent names that indicate the parameter's purpose."]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Provide meaningful defaults"}),": Set reasonable default values that work in most scenarios."]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Validate parameters"}),": Use parameter callbacks to validate values and prevent invalid configurations."]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Document parameters"}),": Use parameter descriptors to document the purpose and constraints of each parameter."]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Group related parameters"}),": Organize related parameters logically, especially in configuration files."]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Use appropriate types"}),": Choose the correct parameter type for your data to ensure type safety."]}),"\n"]}),"\n",(0,n.jsxs)(a.li,{children:["\n",(0,n.jsxs)(a.p,{children:[(0,n.jsx)(a.strong,{children:"Consider parameter ranges"}),": For numeric parameters, consider setting reasonable ranges to prevent invalid values."]}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(a.h2,{id:"command-line-tools",children:"Command Line Tools"}),"\n",(0,n.jsx)(a.p,{children:"ROS 2 provides several command-line tools for working with parameters:"}),"\n",(0,n.jsx)(a.pre,{children:(0,n.jsx)(a.code,{className:"language-bash",children:"# List all parameters for a node\nros2 param list <node_name>\n\n# Get a specific parameter value\nros2 param get <node_name> <param_name>\n\n# Set a parameter value\nros2 param set <node_name> <param_name> <value>\n\n# Describe parameters\nros2 param describe <node_name> <param_name>\n\n# Load parameters from a file\nros2 param load <node_name> <param_file.yaml>\n\n# Dump parameters to a file\nros2 param dump <node_name>\n"})}),"\n",(0,n.jsx)(a.h2,{id:"summary",children:"Summary"}),"\n",(0,n.jsx)(a.p,{children:"Parameters provide a flexible way to configure nodes at runtime without recompiling code. They are essential for creating adaptable robotic systems that can be tuned for different environments, robots, or operational requirements. Understanding how to properly declare, use, and validate parameters is crucial for building robust ROS 2 applications."}),"\n",(0,n.jsx)(a.p,{children:"In the next section, we'll explore launch files, which provide a way to start multiple nodes with specific configurations simultaneously."})]})}function d(e={}){const{wrapper:a}={...(0,t.R)(),...e.components};return a?(0,n.jsx)(a,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},8453:(e,a,r)=>{r.d(a,{R:()=>i,x:()=>o});var n=r(6540);const t={},s=n.createContext(t);function i(e){const a=n.useContext(s);return n.useMemo(function(){return"function"==typeof e?e(a):{...a,...e}},[a,e])}function o(e){let a;return a=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),n.createElement(s.Provider,{value:a},e.children)}}}]);